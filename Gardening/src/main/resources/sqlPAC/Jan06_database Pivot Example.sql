-- PIVOT ; 99 PAGE 
SELECT M_ID
	, SUM(DECODE(WEEK_ID, 1, SALE_CNT)) W_1
	, SUM(DECODE(WEEK_ID, 2, SALE_CNT)) W_2
	, SUM(DECODE(WEEK_ID, 3, SALE_CNT)) W_3
	, SUM(DECODE(WEEK_ID, 4, SALE_CNT)) W_4
	, SUM(DECODE(WEEK_ID, 5, SALE_CNT)) W_5
	, SUM(DECODE(WEEK_ID, 6, SALE_CNT)) W_6
	, SUM(DECODE(WEEK_ID, 7, SALE_CNT)) W_7
FROM (
	SELECT TO_CHAR(SALE_DATE, 'MM') M_ID
				, TO_CHAR(SALE_DATE,'D') WEEK_ID
				,SALE_CNT
	FROM (
		SELECT (TO_DATE('20160101','YYYYMMDD') + LEVEL-1) SALE_DATE
					, TRUNC(DBMS_RANDOM.VALUE(1,1000)) SALE_CNT
		FROM DUAL
		CONNECT BY LEVEL-1 <= TO_DATE('20161231','YYYYMMDD') - TO_DATE('20160101', 'YYYYMMDD')
	)
)
GROUP BY M_ID
ORDER BY 1;




-- PIVOT-1

SELECT * 
FROM 
(
	SELECT TO_CHAR(SALE_DATE, 'MM') M_ID
			, TO_CHAR(SALE_DATE, 'DD') D_ID
			, TO_CHAR(SALE_DATE, 'D') WEEK_ID
			, SALE_CNT
	FROM (
		SELECT (TO_DATE('20160101','YYYYMMDD') + LEVEL-1) SALE_DATE
					, TRUNC(DBMS_RANDOM.VALUE(1,1000))  SALE_CNT
		FROM DUAL
		CONNECT BY LEVEL-1 <= TO_DATE('20161231','YYYYMMDD') -TO_DATE('20160101', 'YYYYMMDD')
	)
)
PIVOT
(
		SUM(SALE_CNT) S
	,	COUNT(*) CNT
	,	MIN(SALE_CNT) MI
	,	MAX(SALE_CNT) MX
	FOR WEEK_ID IN (1,2,3,4,5,6)
)
ORDER BY M_ID, D_ID;



-- PIVOT-2

SELECT * 
FROM (
	SELECT TO_CHAR(SALE_DATE, 'MM') M_ID
			--	, TO_CHAR(SALE_DATE, 'DD') D_ID
				, TO_CHAR(SALE_DATE, 'D') WEEK_ID
				, SALE_CNT
	FROM (
		SELECT (TO_DATE('20160101','YYYYMMDD') + LEVEL-1) SALE_DATE
					, TRUNC(DBMS_RANDOM.VALUE(1,1000)) SALE_CNT
		FROM DUAL
		CONNECT BY LEVEL-1 <= TO_DATE('20161231','YYYYMMDD') - TO_DATE('20160101','YYYYMMDD') 
	)
)
PIVOT
(
		SUM(SALE_CNT) S 
	--	, COUNT(*) CNT
	--	, MIN(SALE_CNT) MI 
	--	, MAX(SALE_CNT) MX 
		FOR WEEK_ID IN (1,2,3,4,5,6)
)
ORDER BY M_ID;




-- PIVOT-3
SELECT * 
FROM (
	SELECT TO_CHAR(SALE_DATE, 'MM') M_ID
			,  TO_CHAR(SALE_DATE, 'DD') D_ID
			,  TO_CHAR(SALE_DATE, 'D') WEEK_ID
			,  SALE_CNT
	FROM (
		SELECT (TO_DATE('20160101', 'YYYYMMDD') + LEVEL-1) SALE_DATE
					, TRUNC(DBMS_RANDOM.VALUE(1,1000)) SALE_CNT
		FROM DUAL
		CONNECT BY LEVEL-1 <= TO_DATE('20161231', 'YYYYMMDD') - TO_DATE('20160101' , 'YYYYMMDD')
	)
)
PIVOT
(
		SUM(SALE_CNT) S
	--,	COUNT(*) CNT
	--,	MIN(SALE_CNT) MI 
	--,	MAX(SALE_CNT) MX
	FOR WEEK_ID IN (1,2,3,4,5,6)
)
ORDER BY M_ID;




-- PIVOT-4
SELECT * 
FROM 
(
	SELECT 'ODD' GBN,1 COL1, 3 COL2, 5 COL3, 7 COL4, 9 COL5 FROM DUAL UNION ALL 
	SELECT 'EVN' GBN, 2 COL1, 4 COL2, 6 COL3, 8 COL4, 10 COL5 FROM DUAL
)
UNPIVOT
(
	NO FOR COL_GB IN (COL1,COL2,COL3,COL4,COL5)
)
ORDER BY NO;





