
SELECT *
FROM SALE_TBL;

SELECT * FROM (
SELECT AREA_CD
	, DECODE(PROD_ID, '100000', SALE_CNT) COL1
	, REGION_AREA
	, PROD_ID
	, SUM(SALE_CNT) SALE_CNT
FROM SALE_TBL
WHERE ROWNUM <= 100000
GROUP BY AREA_CD
	, REGION_AREA
	, PROD_ID
ORDER BY 1,2,3
);


DESC VIEW V_STEP1;
DESC VIEW V_ICON_UPDOWN;

SELECT AREA_CD
      ,DECODE(GROUPING(AREA_CD)||GROUPING(REGION_AREA),'00',MIN(CD_NM)
                  ,'01',MIN(CD_NM)||'ÇÕ°è','ÃÑ°è') NM
      ,REGION_AREA
      ,SUM(DECODE(PROD_ID,'100000',SALE_CNT)) COL0
      ,SUM(DECODE(PROD_ID,'100001',SALE_CNT)) COL1
      ,SUM(DECODE(PROD_ID,'100002',SALE_CNT)) COL2
      ,SUM(DECODE(PROD_ID,'100003',SALE_CNT)) COL3
      ,SUM(DECODE(PROD_ID,'100004',SALE_CNT)) COL4
      ,SUM(DECODE(PROD_ID,'100005',SALE_CNT)) COL5
      ,SUM(DECODE(PROD_ID,'100006',SALE_CNT)) COL6
      ,SUM(DECODE(PROD_ID,'100007',SALE_CNT)) COL7
      ,SUM(DECODE(PROD_ID,'100008',SALE_CNT)) COL8
      ,SUM(DECODE(PROD_ID,'100009',SALE_CNT)) COL9
      ,SUM(SALE_CNT) TOT
      ,GROUPING(AREA_CD)||GROUPING(REGION_AREA) GR
FROM(
    SELECT AREA_CD
          ,REGION_AREA
          ,PROD_ID
          ,SUM(SALE_CNT) SALE_CNT
    FROM SALE_TBL    
    GROUP BY AREA_CD
            ,REGION_AREA
            ,PROD_ID
)  TA, CD_TBL TB
WHERE TA.AREA_CD = TB.CD_ID
GROUP BY ROLLUP(AREA_CD ,REGION_AREA)
ORDER BY 1,2;

-- ¼÷Á¦ ½ÃÀÛ


SELECT AREA_CD, NM
	, REGION_AREA
	, DECODE(COL0, GREATEST(COL1, COL2, COL3, COL4, COL5, COL6, COL7 COL8, COL9), COL0 || ROUND(((COL0*100)/ TOT),1)   || ' ¡ã', 
							LEAST(COL1, COL2, COL3, COL4, COL5, COL6, COL7 COL8, COL9), COL0 || ROUND(((COL0*100)/ TOT),1)   || ' ¡å', COL0 || ROUND(((COL0*100)/ TOT),1)  ) 
	
FROM 
(
SELECT AREA_CD
      ,DECODE(GROUPING(AREA_CD)||GROUPING(REGION_AREA),'00',MIN(CD_NM)
                  ,'01',MIN(CD_NM)||'ÇÕ°è','ÃÑ°è') NM
      ,REGION_AREA
      ,SUM(DECODE(PROD_ID,'100000',SALE_CNT)) COL0
      ,SUM(DECODE(PROD_ID,'100001',SALE_CNT)) COL1
      ,SUM(DECODE(PROD_ID,'100002',SALE_CNT)) COL2
      ,SUM(DECODE(PROD_ID,'100003',SALE_CNT)) COL3
      ,SUM(DECODE(PROD_ID,'100004',SALE_CNT)) COL4
      ,SUM(DECODE(PROD_ID,'100005',SALE_CNT)) COL5
      ,SUM(DECODE(PROD_ID,'100006',SALE_CNT)) COL6
      ,SUM(DECODE(PROD_ID,'100007',SALE_CNT)) COL7
      ,SUM(DECODE(PROD_ID,'100008',SALE_CNT)) COL8
      ,SUM(DECODE(PROD_ID,'100009',SALE_CNT)) COL9
      ,SUM(SALE_CNT) TOT
      ,GROUPING(AREA_CD)||GROUPING(REGION_AREA) GR
FROM(
    SELECT AREA_CD
          ,REGION_AREA
          ,PROD_ID
          ,SUM(SALE_CNT) SALE_CNT
    FROM SALE_TBL    
    GROUP BY AREA_CD
            ,REGION_AREA
            ,PROD_ID
)  TA, CD_TBL TB
WHERE TA.AREA_CD = TB.CD_ID AND AREA_CD = 10
GROUP BY ROLLUP(AREA_CD ,REGION_AREA)
ORDER BY 1,2

);




SELECT * FROM EXAM_RSLT;

