
--계층형쿼리

SELECT SYS_CONNECT_BY_PATH(DGT, '>') PATH
		, LEVEL LV
FROM HIR_TST
CONNECT BY PRIOR DGT = PDGT 
START WITH DGT=1;



CREATE TABLE DIA_HIR_TST AS
SELECT * FROM HIR_TST;

INSERT INTO DIA_HIR_TST 
SELECT '10','11' FROM DUAL ;

COMMIT;

SELECT * FROM DIA_HIR_TST;



-- CYCLE이 도는 것을 걸러내서 표현해줌 
SELECT LPAD(' ', (LEVEL-1)*6) || 'L' || DGT DGT_TREE
	, CONNECT_BY_ROOT DGT 
	, DGT 
	, PDGT 
	, CONNECT_BY_ISCYCLE CYC 
FROM DIA_HIR_TST 
CONNECT BY NOCYCLE PRIOR DGT = PDGT 
START WITH DGT = 1;


SELECT LPAD(' ',(LEVEL-1)*6) || 'L' || DGT DGT_TREE 
		, CONNECT_BY_ROOT DGT 
		, DGT 
		, PDGT
FROM HIR_TST
WHERE DGT <> 2 
CONNECT BY PRIOR DGT = PDGT 
START WITH DGT = 1;


SELECT LPAD(' ', (LEVEL-1 )*6) || 'L' || DGT DGT_TREE
	,CONNECT_BY_ROOT DGT 
	, DGT
	, PDGT 
FROM HIR_TST
CONNECT BY PRIOR DGT = PDGT AND DGT <> 2
START WITH DGT = 1;


SELECT SYS_CONNECT_BY_PATH(DGT,'L') PATH 
		, LPAD(' ', (LEVEL-1)*6) || 'L' || DGT S 
		, CONNECT_BY_ROOT DGT SYS_ROOT 
		, DGT 
		, PDGT 
FROM HIR_TST
CONNECT BY PRIOR PDGT = DGT 
START WITH DGT IN (5,6,7);



SELECT 
		LTRIM(MAX(SYS_CONNECT_BY_PATH(NID, '+')), '+') || '=' || SUM(NID) PP
FROM 
(
SELECT 
	ROWNUM + :ST -1  NID
	, ROWNUM + :ST  PID
FROM DUAL
CONNECT BY LEVEL <= :ED - :ST + 1
) 
CONNECT BY PRIOR DECODE(:A, 'F', PID, NID) = DECODE(:A, 'F', NID, PID) 
START WITH NID = DECODE(:A, 'F', :ST, :ED)
;













